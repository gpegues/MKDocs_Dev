<!DOCTYPE html><html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <title>Mailremoval | Managed Services KB</title>

    
    

    
    
    <link href="../../assets/css/main.css" rel="stylesheet">
    
    <link href="../../assets/css/custom.css" rel="stylesheet">
    
    <link href="../../assets/css/print.css" rel="stylesheet">
    

    
    
    

    
    <script type="text/javascript">
        /* eslint-disable */
        // prettier-ignore
        var base_url = "../..";
        /* eslint-enable */
    </script>

<link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
        </style></head>
<body class="theme-blackout"> 

    
    <header class="bo-header">
    <div class="bo-container bo-header-grid">

        
        <button class="bo-sidebar-toggle" id="bo-sidebar-toggle" aria-label="Toggle Navigation">
            <span class="bo-icon-menu"></span> 
        </button>

        
        <div class="bo-header-title">
            <a href="../.." title="Managed Services KB">
                
                
                Managed Services KB
            </a>
        </div>

        
        

        
        
        <div class="bo-header-search">
            
            <button class="bo-search-toggle" data-search-toggle title="Search (Ctrl+K)">
                <span class="bo-search-icon"></span> 
                <span class="bo-search-text">Search</span>
                <span class="bo-search-shortcut">Ctrl K</span>
            </button>
        </div>
        

        
        
        <div class="bo-header-repo">
            <a href="https://github.com/rivcoit/MKDocs" target="_blank" rel="noopener" title="View on GitHub" aria-label="View repository on GitHub">
                <svg viewBox="0 0 16 16" width="20" height="20" aria-hidden="true">
                    <path fill="currentColor" d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path>
                </svg>
            </a>
        </div>
        

    </div>
</header>

    
    <div class="bo-container">
        <div class="bo-main-grid">

            
            <aside class="bo-sidebar bo-sidebar-left">
                



<nav class="bo-nav-main">
  <ul class="bo-nav-list">
    
      
<li class="bo-nav-item  ">
  
    <a href="../.." class="bo-nav-link">
      Managed Services
    </a>
  
</li>

    
      
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Enterprise Notifications
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../EnterpriseNotifications/Export%20a%20wiki%20to%20a%20OneNote%20notebook%20in%20Microsoft%20Teams/" class="bo-nav-link">
      Export a Wiki to OneNote
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../EnterpriseNotifications/Important%20Update%20Changes%20to%20Note-Taking%20%28Wiki%29%20in%20Microsoft%20Teams/" class="bo-nav-link">
      Wiki Changes
    </a>
  
</li>
 
      
    </ul>
  
</li>

    
      
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Exchange
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../" class="bo-nav-link">
      General Information
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      eDiscovery
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../eDiscoveryLitigation/" class="bo-nav-link">
      eDiscovery Litigation
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../mailremovaldefender/" class="bo-nav-link">
      Email Removal Requests
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Mailboxes
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../RemoteEnableUser/" class="bo-nav-link">
      Creating User Email
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../MessageTrace/" class="bo-nav-link">
      Message Trace
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../scan2email/" class="bo-nav-link">
      SMTP to SharedMailbox
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Misc.
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      3rd Party
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../3rdParty/TangoReserve/TRSetupChecklist/" class="bo-nav-link">
      TangoReserve
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../Help%20Desk%20Support%20for%20Outlook/" class="bo-nav-link">
      Help Desk Support
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../NextRequest-PublicRecordsRequests/" class="bo-nav-link">
      Next Request - PRAs
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../Role%20Clarification%20for%20M365%20Services%20and%20Help%20Desk/" class="bo-nav-link">
      Role Clarification
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Server
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../Server%202016/Create%20New%20Edge%20Subscription/" class="bo-nav-link">
      Edge Subscription
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../Exchange%202016%20server%20%28Non-DAG%20Setup%29%20maintenance%20mode/" class="bo-nav-link">
      Maintenance Mode
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      User Documentation
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../UserDocumentation/M365-ExchangeOnline-UserCalendarManagement/" class="bo-nav-link">
      Calendar Management
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../UserDocumentation/M365-ExchangeOnline%20Distribution%20Group%20Management%20%28EndUser%29/" class="bo-nav-link">
      Distribution Group Management
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../UserDocumentation/M365-ExchangeOnline%20Distribution%20Group%20Types/" class="bo-nav-link">
      Distribution Group Types
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../UserDocumentation/M365-ExchangeOnline%20ServiceNow%20Request%20Submission%20Guidelines%20for%20Microsoft%20365%20Exchange%20Online%20Resource%20Access/" class="bo-nav-link">
      ServiceNow Request Guidelines
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../UserDocumentation/M365-ExchangeOnline%20Autoreply%20for%20Shared%20Mailboxes/" class="bo-nav-link">
      Updating Auto-Reply
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
    </ul>
  
</li>

    
      
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      GitHub
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Actions
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../GitHub/ActionsAutomations/" class="bo-nav-link">
      Automations
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../GitHub/Onboarding/" class="bo-nav-link">
      Onboarding
    </a>
  
</li>
 
      
    </ul>
  
</li>

    
      
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      M365
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../M365/" class="bo-nav-link">
      General Information
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../M365/Framework-BotApproval-M365/" class="bo-nav-link">
      Bots
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../M365/Bookings/BookingsGovernance/" class="bo-nav-link">
      Bookings
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Licensing
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../M365/Licensing/" class="bo-nav-link">
      General Information
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../M365/LicenseGroups/" class="bo-nav-link">
      Licensing Groups
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Misc
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../M365/CalendarOptionsinM365/" class="bo-nav-link">
      Calendar Options
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Power BI
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../M365/PowerBI/PublishtoWebGuidelines/" class="bo-nav-link">
      Publish to Web
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Data Gateway Cluster Server Management
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../M365/PowerBI/datagateways/patching-clustered-gateways/" class="bo-nav-link">
      Updating the Data Gateway Cluster
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../M365/PowerBI/datagateways/gateway-additional-applications/" class="bo-nav-link">
      Additional Applications
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
    </ul>
  
</li>
 
      
    </ul>
  
</li>

    
      
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Misc
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../Misc/Syncs/" class="bo-nav-link">
      Syncs
    </a>
  
</li>
 
      
    </ul>
  
</li>

    
      
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Teams
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../Teams/" class="bo-nav-link">
      General Information
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../Teams/DeviceProvisioning/" class="bo-nav-link">
      Device Provisioning
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../Teams/DeviceManagement/" class="bo-nav-link">
      Device Management
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Policies
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../Teams/Policies/Recording/" class="bo-nav-link">
      Recording
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Troubleshooting
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../Teams/Troubleshooting/UnblockUser/" class="bo-nav-link">
      Unblock Users
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
    </ul>
  
</li>

    
      
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Web Server Support
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/" class="bo-nav-link">
      General
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      FTP
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/FTP/general/" class="bo-nav-link">
      GENERAL
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      CERBERUS
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/FTP/docs/Cerberus-ApplicationUpdate/" class="bo-nav-link">
      Application Update
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/FTP/docs/Cerberus-FTPGroupCreation/" class="bo-nav-link">
      FTP Group Creation
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
    </ul>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Servers
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      IIS
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      RIVCO
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/IIS/RIVCOCA/RCIT-16WEB01/" class="bo-nav-link">
      RCIT-16WEB01
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/IIS/RIVCOCA/RCIT-16WEB01T/" class="bo-nav-link">
      RCIT-16WEB01T
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      TZONE
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/IIS/TZONE/TZVM101/" class="bo-nav-link">
      TZVM101
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/IIS/TZONE/TZVM102/" class="bo-nav-link">
      TZVM102
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/IIS/TZONE/TZVM103/" class="bo-nav-link">
      TZVM103
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/IIS/TZONE/TZVM104/" class="bo-nav-link">
      TZVM104
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/IIS/TZONE/TZVM105/" class="bo-nav-link">
      TZVM105
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/IIS/TZONE/TZVM106/" class="bo-nav-link">
      TZVM106
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
    </ul>
  
</li>
 
      
    </ul>
  
</li>
 
      
        
<li class="bo-nav-item  has-children">
  
    <a href="javascript:void(0);" class="bo-nav-link">
      Certify The Web
    </a>
    <ul class="bo-nav-list is-child-list">
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/certifytheweb/ProcessOutline.md" class="bo-nav-link">
      Process Outline
    </a>
  
</li>
 
      
        
<li class="bo-nav-item  ">
  
    <a href="../../WebServerSupport/certifytheweb/" class="bo-nav-link">
      Deployment Guide
    </a>
  
</li>
 
      
    </ul>
  
</li>
 
      
    </ul>
  
</li>

    
  </ul>
</nav>
            </aside>

            
            <main class="bo-content">
                
                
                <div class="bo-page-meta-top">
                    
                    
                </div>
                
                
                <article class="bo-article">
                    
                        <table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">SUMMARY:</td>
<td style="text-align: center;">Information regarding Messaging Team responsibilities and Email Removal Requests</td>
</tr>
<tr>
<td style="text-align: center;">DEPT or DIVISION AFFECTED:</td>
<td style="text-align: center;">All County of Riverside (RCIT) supported computers</td>
</tr>
<tr>
<td style="text-align: center;">EMPLOYEES RESPONSIBLE:</td>
<td style="text-align: center;">All</td>
</tr>
<tr>
<td style="text-align: center;">TOOLS / APPLICATIONS:</td>
<td style="text-align: center;">Service Now, Outlook, PowerShell, Microsoft Purview (Compliance), and Exchange Online</td>
</tr>
</tbody>
</table>
<h2 id="introduction"><strong>Introduction</strong><a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>The intent of this document is to provide information regarding the Messaging Team and its internal procedures for dealing with email removal requests. Further updates can and should be made to this document by additional members of the Messaging Team.  </p>
<h3 id="general-information"><strong>General Information</strong><a class="headerlink" href="#general-information" title="Permanent link">¶</a></h3>
<p>While not common, you will receive incident and/or task escalations which will require the Messaging Team to act by utilizing the mass removal email from mailboxes. This can occur from one of several (but not limited to) possible scenarios below:  </p>
<ul>
<li>
<p>Rivco Mailbox User accidentally sends out unintended mail to a large number of mailboxes internally.  </p>
<ul>
<li>We will define “a large number of mailboxes” as <span style="color:red">100 or more recipients</span> as of the time this document was drafted.  </li>
</ul>
</li>
<li>
<p>Rivco Mailbox Users have mass received a malicious email which was not detected/quarantined by our security protocols (Proofpoint, etc.)  </p>
</li>
<li>
<p>Requests from Management.  </p>
</li>
</ul>
<h3 id="info-email-removal-request-services-messaging-cannot-provide"><strong>Info - Email Removal Request - Services Messaging cannot provide</strong><a class="headerlink" href="#info-email-removal-request-services-messaging-cannot-provide" title="Permanent link">¶</a></h3>
<ul>
<li>
<p>Messaging cannot remove mail cached on mobile/iOS devices.  </p>
</li>
<li>
<p>Messaging cannot retrieve mail which has been sent to an external recipient  </p>
</li>
</ul>
<h3 id="info-email-removal-request-admin-requirements"><strong>Info - Email Removal Request – Admin Requirements</strong><a class="headerlink" href="#info-email-removal-request-admin-requirements" title="Permanent link">¶</a></h3>
<ul>
<li>
<p>Permission required to search mailboxes and delete messages: The account must be a member of the eDiscovery Manager role group or be assigned the Compliance Search management role. </p>
</li>
<li>
<p>Permission required to delete messages: The account must be a member of the Organization Management role group or be assigned the Search and Purge management role </p>
</li>
<li>
<p>Permission required to preview messages: The account must be a member of the eDiscovery Manager role group or be assigned the Preview management role </p>
</li>
<li>
<p><span style="color:red">PowerShell must be connected to the Office 365 Security &amp; Compliance Center PowerShell. This requires you to import the ExchangeOnlineManagement module in PowerShell and open a connection with the compliance center (Purvue).</span></p>
</li>
</ul>
<p></p><div class="language-Powershell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">Import-Module</span> <span class="n">ExchangeOnlineManagement</span> 
</span></code></pre></div>
<div class="language-Powershell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">Connect-IPPSSession</span> <span class="n">-UserPrincipalName</span> <span class="s2">"yourusername@contoso.com"</span>
</span></code></pre></div><p></p>
<details class="info" open="open">
<summary>Info</summary>
<p>Connect to Security &amp; Compliance PowerShell: <a href="https://learn.microsoft.com/en-us/powershell/exchange/connect-to-scc-powershell?view=exchange-ps">Connect to Security &amp; Compliance PowerShell</a></p>
</details>
<h3 id="info-email-removal-request-ticket-information-requirement-inc"><strong>Info - Email Removal Request – Ticket Information Requirement (INC)</strong><a class="headerlink" href="#info-email-removal-request-ticket-information-requirement-inc" title="Permanent link">¶</a></h3>
<p>Once an email removal request has been received, you will want to gather as much data as possible about the message that needs to be deleted. Without obtaining precise data and search criteria, <span style="color:red">you will run the risk of potentially creating a query which may result in unintentionally deleting unintended email.  </span></p>
<p><span style="text-decoration:underline"><strong>Critical information required prior to processing a request</strong></span></p>
<ul>
<li>
<p><span style="color:red">What is the sender’s email address? (Required) </span></p>
</li>
<li>
<p><span style="color:red">What is the message subject? (Required) </span></p>
</li>
<li>
<p>Are there file attachments, and what are the filenames?</p>
</li>
<li>
<p>What’s the date of the first reported occurrence? </p>
</li>
<li>
<p>Who are the recipients? </p>
</li>
</ul>
<p>Items listed above in <span style="color:red">red</span> are requirements. Requests lacking this information will be rejected and sent back to the escalating individual or submitter.  </p>
<h3 id="email-removal-request-create-content-search"><strong>Email Removal Request – Create Content Search</strong><a class="headerlink" href="#email-removal-request-create-content-search" title="Permanent link">¶</a></h3>
<p>There are multiple ways to create a content search, both via PowerShell and through the Compliance portal (Compliance.microsoft.com). This document will cover only the PowerShell aspect of this task, as removal actions after creating a content search are not present in the Compliance Portal, which require PowerShell to complete. </p>
<p><span style="text-decoration:underline"><strong>Example Request:</strong></span>  </p>
<p><em>Remove email with the following criteria</em></p>
<p><span style="color:red"><strong>Subject:</strong> You must change your bank password now</span></p>
<p><span style="color:red"><strong>Sent:</strong> 05/12/2020</span></p>
<p>Using the <code>New-ComplianceSearch</code> cmdlet in PowerShell, the message properties listed above will be used to create a search query. The key to keeping the search results as accurate as possible depends on the adequately formulated search criteria.  </p>
<details class="example" open="open">
<summary>Example</summary>
<p>This creates a compliance search with the -Name provided being the name of the search for further interactions. <code>ContentMatchQuery</code> is the input for search parameters. </p>
<p></p><div class="language-Powershell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">New-ComplianceSearch</span> <span class="n">-Name</span> <span class="n">Phish1</span> <span class="n">-ExchangeLocation</span> <span class="n">All</span> <span class="n">-ContentMatchQuery</span> <span class="s1">'subject:"You must change your bank password now" AND sent:05/12/2020'</span> 
</span></code></pre></div>
This creates the search; however, it does not start it. To start the search continuing with the above example, you would use the following command supplied with the <code>-Name</code> you gave the search: <p></p>
<p></p><div class="language-Powershell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">Start-ComplianceSearch</span> <span class="n">-Identity</span> <span class="n">Phish1</span>
</span></code></pre></div>
After starting this search, this may take several minutes to the upwards of an hour to complete. To check the status of this search, running the following will give you a status: <p></p>
<div class="language-Powershell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nb">Get-ComplianceSearch</span> <span class="n">-Identity</span> <span class="n">Phish1</span> 
</span></code></pre></div>
<p>If <strong>“Status”</strong> does not equal <strong>“Complete”</strong>, you will need to wait for this process to finish before proceeding.  </p>
<p>If you would like to check the number of items indexed through the Content Search, one way to obtain this (but not limited to) would be as follows:  </p>
<p></p><div class="language-Powershell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nb">Get-ComplianceSearch</span> <span class="n">-Identity</span> <span class="n">Phish1</span> <span class="p">|</span> <span class="nb">Format-List</span> <span class="p">*</span> 
</span></code></pre></div>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/emailremoval1.PNG" data-desc-position="bottom"><img alt="Screenshot" src="../../img/emailremoval1.PNG"></a><p></p>
</details>
<h3 id="email-removal-request-previewing-search-results"><strong>Email Removal Request – Previewing Search Results</strong><a class="headerlink" href="#email-removal-request-previewing-search-results" title="Permanent link">¶</a></h3>
<p>Prior to email deletion, you should review the result of your search. To preview the search results, you now need to create a preview action using the command below. </p>
<div class="language-Powershell highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nb">New-ComplianceSearchAction</span> <span class="n">-SearchName</span> <span class="n">Phish1</span> <span class="n">-Preview</span> 
</span></code></pre></div>
<p>This will start processing a job like we did prior in the <a href="#email-removal-request-create-content-search">Email Removal Request – Create Content Search</a> step. This will also take the name you gave the search and append an <code>_Preview</code> to its name.  </p>
<p>Example: <code>Phish1_Preview</code>  </p>
<p>Once these results have completed. You can then run the following command to get the output of the results:  </p>
<p></p><div class="language-Powershell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="p">(</span><span class="nb">Get-ComplianceSearchAction</span> <span class="n">Phish1_Preview</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-ExpandProperty</span> <span class="n">Results</span><span class="p">)</span> <span class="n">-split</span> <span class="s2">","</span>  
</span></code></pre></div>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/emailremoval2.PNG" data-desc-position="bottom"><img alt="Screenshot" src="../../img/emailremoval2.PNG"></a><p></p>
<p><em>Note: This report can also be exported from the Compliance Center as a secondary option</em> </p>
<h3 id="email-removal-request-delete-email-from-inboxes"><strong>Email Removal Request – Delete email from inboxes</strong><a class="headerlink" href="#email-removal-request-delete-email-from-inboxes" title="Permanent link">¶</a></h3>
<p>To delete the messages that matched the search criteria, you need to create a purge job using the <code>New-ComplianceSearchAction</code> cmdlet with the <code>-Purge</code> switch and <code>-PurgeType</code> parameter. </p>
<p><em><span style="color:red">Important:</span> <code>-PurgeType</code> parameter <code>SoftDelete</code> will move all mail into the effected mailboxes recovery inbox. This also means that a user may be able to recover this email if they go into the recovery folder and restore.</em> </p>
<p><span style="color:red">For permanent deletion</span> use parameter <code>HardDelete</code>  </p>
<p><span style="color:red">Additionally, unlike <code>New-ComplianceSearch</code> once you run this command, the job will automatically start. Once run, you will be unable to recover email (if needed) if using the <code>HardDelete</code> parameter. Proceed with caution.</span></p>
<details class="example" open="open">
<summary>Example</summary>
<div class="language-Powershell highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">New-ComplianceSearchAction</span> <span class="n">-SearchName</span> <span class="n">Phish1</span> <span class="n">-Purge</span> <span class="n">-PurgeType</span> <span class="n">SoftDelete</span> 
</span></code></pre></div>
<p>Like preceding items, this will create a purge job, affixed with the tag <code>_Purge</code>. This can be used to view the final result. </p>
</details>
<details class="example" open="open">
<summary>Example</summary>
<p></p><div class="language-Powershell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nb">Get-ComplianceSearchAction</span> <span class="n">-Identity</span> <span class="n">Phish1_Purge</span> <span class="p">|</span> <span class="nb">Format-List</span>
</span></code></pre></div>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/emailremoval3.PNG" data-desc-position="bottom"><img alt="Screenshot" src="../../img/emailremoval3.PNG"></a><p></p>
</details>
<h3 id="email-removal-request-service-now-ticket-closure-requirements"><strong>Email Removal Request – Service Now Ticket Closure Requirements</strong><a class="headerlink" href="#email-removal-request-service-now-ticket-closure-requirements" title="Permanent link">¶</a></h3>
<p>After completion of an Email Removal Request. We need to place resolution data in the submitted Service Now ticket. This would include compliance search query, and its final result after completing steps in <a href="#email-removal-request-delete-email-from-inboxes">Email Removal Request – Delete email from inboxes</a>.  </p>
<p>Until this is further improved upon, the recommendation is that we attach the following to each completed request: </p>
<ul>
<li>
<p>The report query which shows the compliance search parameters and discovered items – This can be done in one of several ways: PowerShell Export or a CSV Export from the Compliance Center using the case name. If opting for PowerShell, please follow the native export formatting from the Compliance Center to keep items consistent. </p>
</li>
<li>
<p>An export of the <code>Get-ComplianceSearchAction</code> cmdlet, attached or pasted into the work notes. 
</p><div class="language-Powershell highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nb">Get-ComplianceSearchAction</span> <span class="n">-Identity</span> <span class="n">Phish1_Purge</span> <span class="p">|</span> <span class="nb">Format-List</span> 
</span></code></pre></div><p></p>
</li>
</ul>
<p>The reason for this, is that in the event of any questions or audits on why we have completed a request of this nature, it allows for Service Now to be the center point of determining why something was completed. Additionally, in the event a request is made that is later found to be a mistake, we have evidence of why said request was completed and documented in a central location.  </p>
                    
                </article>
                
                
                
                <div class="bo-page-meta-bottom">
                    <div class="bo-page-meta-info">
                        
                        
                        <div class="bo-meta-item">
                            <svg class="bo-meta-icon" viewBox="0 0 16 16" width="14" height="14">
                                <path fill="currentColor" d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm7-3.25v2.992l2.028.812a.75.75 0 0 1-.557 1.392l-2.5-1A.751.751 0 0 1 7 8.25v-3.5a.75.75 0 0 1 1.5 0Z"></path>
                            </svg>
                            <span>Last updated: <time datetime="&lt;span class=" git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="July 17, 2023 22:34:09 UTC">July 17, 2023 22:34:09</time></span>"&gt;<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="July 17, 2023 22:34:09 UTC">July 17, 2023 22:34:09</span>
                        </div>
                        
                        
                        
                        
                        <div class="bo-meta-item">
                            <a href="https://github.com/rivcoit/MKDocs/edit/main/docs/Exchange/mailremoval.md" target="_blank" rel="noopener" class="bo-edit-link">
                                <svg class="bo-meta-icon" viewBox="0 0 16 16" width="14" height="14">
                                    <path fill="currentColor" d="M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25c.081-.286.235-.547.445-.758l8.61-8.61Zm.176 4.823L9.75 4.81l-6.286 6.287a.253.253 0 0 0-.064.108l-.558 1.953 1.953-.558a.253.253 0 0 0 .108-.064Zm1.238-3.763a.25.25 0 0 0-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 0 0 0-.354Z"></path>
                                </svg>
                                Edit this page
                            </a>
                        </div>
                        
                    </div>
                </div>
                
            </main>

            
            
            
            <aside class="bo-sidebar bo-sidebar-right">
                



<div class="bo-toc-main">
    <h4 class="bo-toc-title">On this page</h4>
    <ul class="bo-toc-list">
        
            
    <li class="bo-toc-item">
        <a href="#introduction" class="bo-toc-link">Introduction</a>
        
            <ul class="bo-toc-list is-child-list">
                
                    
    <li class="bo-toc-item">
        <a href="#general-information" class="bo-toc-link">General Information</a>
        
    </li>
 
                
                    
    <li class="bo-toc-item">
        <a href="#info-email-removal-request-services-messaging-cannot-provide" class="bo-toc-link">Info - Email Removal Request - Services Messaging cannot provide</a>
        
    </li>
 
                
                    
    <li class="bo-toc-item">
        <a href="#info-email-removal-request-admin-requirements" class="bo-toc-link">Info - Email Removal Request – Admin Requirements</a>
        
    </li>
 
                
                    
    <li class="bo-toc-item">
        <a href="#info-email-removal-request-ticket-information-requirement-inc" class="bo-toc-link">Info - Email Removal Request – Ticket Information Requirement (INC)</a>
        
    </li>
 
                
                    
    <li class="bo-toc-item">
        <a href="#email-removal-request-create-content-search" class="bo-toc-link">Email Removal Request – Create Content Search</a>
        
    </li>
 
                
                    
    <li class="bo-toc-item">
        <a href="#email-removal-request-previewing-search-results" class="bo-toc-link">Email Removal Request – Previewing Search Results</a>
        
    </li>
 
                
                    
    <li class="bo-toc-item">
        <a href="#email-removal-request-delete-email-from-inboxes" class="bo-toc-link">Email Removal Request – Delete email from inboxes</a>
        
    </li>
 
                
                    
    <li class="bo-toc-item">
        <a href="#email-removal-request-service-now-ticket-closure-requirements" class="bo-toc-link">Email Removal Request – Service Now Ticket Closure Requirements</a>
        
    </li>
 
                
            </ul>
        
    </li>

        
    </ul>
</div>
            </aside>
            

        </div> 
    </div> 

    
    <footer class="bo-footer">
  <div class="bo-footer-content">
    
    <small>
      
        Copyright © 2025 RCIT
      
    </small>
    
    
    <small class="bo-footer-credits">
      Built with <a href="https://www.mkdocs.org/" target="_blank" rel="noopener">MkDocs</a>
    </small>
  </div>
</footer>

    
    
    <script src="../../assets/js/lunr.min.js"></script>
    
    <script src="../../assets/js/search-worker.js"></script>
    
    <script src="../../assets/js/search.js"></script>
    
    <script src="../../assets/js/enhancements.js"></script>
    
    <script src="../../assets/js/main.js"></script>
    
    <script src="../../search/main.js"></script>
    

    
    
        
        
<div class="bo-search-modal" id="search-modal" data-search-modal>
  <div class="bo-search-modal-container">
    <div class="bo-search-modal-header">
      <h3 class="bo-search-modal-title">Search</h3>
      <button class="bo-search-modal-close" data-search-close>×</button>
    </div>
    
    
    <input type="search" class="bo-search-modal-input" id="mkdocs-search-query" placeholder="Type to start searching..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
    
    
    <div class="bo-search-results" id="mkdocs-search-results">
      
      <p>Type search query above.</p>
    </div>
  </div>
</div>
    


<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
</script></body></html>